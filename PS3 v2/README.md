
### Problem 1a
To assemble the stoichiometric matrix "s", I used the diagram in the problem statement as well as KEGG database to generate a list of all compounds involved in the urea cycle. Rows represent compounds while columns represent reactions. The first 6 reactions are those that are included directly in the urea cycle based on the diagram provided, with 5 and 6 being the same reaction but in different directions. The next 4 reactions represent the exchanges that are shown in the diagram. Finally, the remaining 10 reactions are those that I needed to fill in to account for the presence of substrates or products that aren't involved in any of the other reactions, since they just can't appear out of no where. A detailed matrix is included in the excel file ``stoichiometric matrix definition.xlsx``. A few notes: 1. I split reaction 5 into 5 and 6, since that reaction is reversible. 2. Direction of the boundary exchanges based on what needs to be able to carry flux.

### Problem 1b
To determine if my s is elementally balanced, I first needed to assemble an atom matrix "a". This atom matrix has rows as compounds, as columns as the atoms C H N O P S. Again, KEGG is used to populate this matrix, also detailed in ``stoichiometric matrix definition.xlsx``.

S and a are then stored in txt files ``stoichiometric.txt`` and ``atom.txt`` respectively. To check if s is elementally balanced, type **include("Balances.jl")**, which will perform the transpose of a multiplied by s. This should be all 0s if balanced, which if we look at the first 6 (internal) reactions, my S is balanced (answer1). However, the boundary reactions are not, which don't really matter for this context. To remedy this, I can follow the previous year's example and include the boundary species reactions in s and a. These are also detailed in the aforementioned excel file, and then transferred to text files ``s_v2.txt`` and ``a_v2.txt``. Upon running the same calculation with these version 2 matrices, everything is now 0! Run **include("Balances.jl")** to see this!

### Problem 2
My first run through can be seen by running **include("Run_me.jl")**. For my first attempt, I used the E and Kcats given in the problem statement to calculate Vmax for my main 6 reactions. For all other reactions, I bounded them either by 0 to 10.0 (for the b reactions whose directions were defined in the diagram) or -10 to 10 (for the last 10 reactions where I had to fill in the blanks myself, as I don't know which direction they go in). The objective is to maximize urea, so maximize reaction 10 (-1 coefficient in the objective vector since Flux.jl is set for min). Lastly, species bounds are 0 since we are at steady state. This gave me an answer of about **2.2284 mmol/gDW-hr.** Some notes: 1. I let the last 10 exchanges go from -10 to 10 because I don't really know for sure which direction they go in. Water in particular is let open because I'd assume it freely exchanges.

However, I needed to include the metabolite and Km constraints from Park 2016. I used their absolute metabolite concentrations where possible, and I used BRENDA for Kms as that's where they derived their Kms from. I then used these to calculate a new Vmax based on the MM equation, where v = Vmax*[x]/([x] + Km). See ``Metabolite constraints.xlsx`` for details. If there was data for multiple substrates, I used whichever was the lowest V value. If there was not enough data to calculate a new V (either missing metabolite concentrations or missing Kms), I just kept it at Vmax. The new bounds are used in a new calculation that can be ran using **include("Run_modified.jl")**. Here, the new urea max is **1.3025 mmol/gDW-hr**, mostly due to reaction 3 having substrate levels (arginine) much below the Km. For Kms, I used the entry in BRENDA for homosapien and wild-type.

One thing I was still missing was incorporating growth rate, which was given as a doubling time of 20 hrs. This would contribute to a dilution effect, decreasing the fluxes that you can get. Essentially, we would need  **0 = Sv - ux**, where u is the growth rate and x is the metabolite. To remedy this, I included metabolite values from Park 2016, converted to mmoles/gDW, and calculated the growth rate from the given doubling time (see ``Stochiometric matrix definition.xlsx``, sheet metabolite concentration for the calculations), and populated a new stochiometric matrix in S with dilution and S with dilution for v3 by creating a new column for dilution effects (negative because it's subtraction). I then created new txt files with the stochiometric matrix, and updated the flux bounds to either constrain the growth column to 1 (for the v2 version, as I've already applied the growth rate to the stochiometric matrix, see Run_modified2.jl) or to the growth rate (when I didn't apply the growth rate to the dilution terms in the stochiometric matrix, see Run_modified3.jl). Both gave me the same answer, about **0.98643 mmol/gDW-hr**, but the status flag is 4. The cause of this seems to be in my arginine flux, where the uptake array is not exactly 0. To see this, run either **include("Run_modified2.jl") or include("Run_modified3.jl")**, with the differences between these versions described above, but the answer is very similar either way. Some notes: 1. The excel file ``Stochiometric matrix definition.xlsx`` contains multiple work sheets. For this part of the problem, S with dilution for v2 is used for the v2 version, while S with x for v3 is used for the v3 case. 2. ``stoichiometric_v2.txt`` and ``stoichiometric_v3.txt`` feed into ``Run_modified2.jl`` and ``Run_modified3.jl`` respectively.

To solve the issue of the status flag being 4, adding an arginine exchange reaction would be a quick fix.
